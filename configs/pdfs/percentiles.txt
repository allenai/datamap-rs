uv run python/percentile.py /mnt/raid0/ai2-llm/pretraining-data/sources/HuggingFaceFW_finepdfs/deduped_eng_nopii_qualitytagged/ ".metadata.ultrafineweb_quality.__label__pos"  -n 10000000 --weight-by ".text | length"

Sampling files: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 21088/21088 [13:08<00:00, 26.73 files/s]

Collected 9,999,701 samples

==================================================
STATISTICS
==================================================
  Count: 9,999,701
  Total weight: 376,061,325,208
  Mean:  0.329000
  Std:   0.370204
  Min:   0.000010
  Max:   1.000010

--------------------------------------------------
PERCENTILES (weighted)
--------------------------------------------------
      p5: 0.000575
     p10: 0.001793
     p15: 0.003922
     p20: 0.007474
     p25: 0.013133
     p30: 0.021846
     p35: 0.035269
     p40: 0.055727
     p45: 0.086276
     p50: 0.130856
     p55: 0.192578
     p60: 0.277407
     p65: 0.389369
     p70: 0.524368
     p75: 0.668067
     p80: 0.804215
     p85: 0.905691
     p90: 0.966456
     p95: 0.993577